<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dinner Roulette</title>
    <style>
      :root {
        --bg: #0b0d12;
        --card: #121724;
        --text: #e9eefc;
        --muted: #a8b3d6;
        --ring: rgba(255, 255, 255, 0.12);
        --btn: #1d2a4a;
        --btn2: #273760;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
          "Apple Color Emoji", "Segoe UI Emoji";
        background: radial-gradient(1200px 800px at 50% 0%, #152043, var(--bg));
        color: var(--text);
      }

      .wrap {
        max-width: 520px;
        margin: 0 auto;
        padding: 18px 14px 28px;
      }

      .gif {
        height: 150px;
        border: 1px dashed var(--ring);
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.03);
        display: grid;
        place-items: center;
        color: var(--muted);
        margin-bottom: 14px;
        user-select: none;
      }

      .gif img {
        height: 138px;
        width: auto;
        max-width: 100%;
        object-fit: contain;
        border-radius: 14px;
        display: block;
      }

      .card {
        background: rgba(18, 23, 36, 0.88);
        border: 1px solid var(--ring);
        border-radius: 18px;
        padding: 16px;
        backdrop-filter: blur(8px);
      }

      h1 {
        font-size: 20px;
        margin: 0 0 6px;
        letter-spacing: 0.2px;
      }

      p {
        margin: 0 0 14px;
        color: var(--muted);
        font-size: 14px;
        line-height: 1.4;
      }

      .wheel-area {
        display: grid;
        place-items: center;
        gap: 12px;
      }

      .wheel-shell {
        position: relative;
        width: min(92vw, 360px);
        aspect-ratio: 1 / 1;
      }

      .pointer {
        position: absolute;
        left: 50%;
        top: -6px;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 10px solid transparent;
        border-right: 10px solid transparent;
        border-bottom: 18px solid #f7d26a;
        filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.5));
        z-index: 3;
      }

      .rotor {
        position: absolute;
        inset: 0;
        border-radius: 50%;
        transform: rotate(0deg);
        transition: transform 3600ms cubic-bezier(0.1, 0.75, 0.12, 1);
      }

      .wheel {
        position: absolute;
        inset: 0;
        border-radius: 50%;
        border: 1px solid var(--ring);
        box-shadow:
          0 22px 60px rgba(0, 0, 0, 0.55),
          inset 0 0 0 10px rgba(0, 0, 0, 0.18);
        overflow: hidden;
      }

      .labels {
        position: absolute;
        inset: 0;
        border-radius: 50%;
        pointer-events: none;
        z-index: 2;
      }

      .label {
        position: absolute;
        left: 50%;
        top: 50%;
        transform-origin: 0 0;
        font-size: 11px;
        color: rgba(255, 255, 255, 0.92);
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.55);
        width: 140px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .hub {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: linear-gradient(180deg, #2a3862, #172241);
        border: 1px solid var(--ring);
        box-shadow: 0 8px 22px rgba(0, 0, 0, 0.55);
        z-index: 4;
      }

      .btn-row {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
        width: 100%;
      }

      button {
        appearance: none;
        border: 1px solid var(--ring);
        background: linear-gradient(180deg, var(--btn2), var(--btn));
        color: var(--text);
        padding: 12px 14px;
        border-radius: 14px;
        font-weight: 650;
        font-size: 15px;
        letter-spacing: 0.2px;
      }

      button:disabled {
        opacity: 0.55;
      }

      .result {
        width: 100%;
        text-align: center;
        padding: 10px 12px;
        border-radius: 14px;
        border: 1px solid var(--ring);
        background: rgba(255, 255, 255, 0.03);
      }

      .result .small {
        display: block;
        font-size: 12px;
        color: var(--muted);
        margin-bottom: 4px;
      }

      .result .big {
        font-size: 18px;
        font-weight: 750;
        letter-spacing: 0.2px;
      }

      .foot {
        margin-top: 10px;
        text-align: center;
        color: rgba(168, 179, 214, 0.9);
        font-size: 12px;
      }

      .foot code {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="gif" aria-label="GIF placeholder">
        <img
          id="topGif"
          src="https://media1.tenor.com/m/ekOo-1_fJlYAAAAd/spice-adams.gif"
          alt="Dinner roulette gif"
          loading="eager"
        />
      </div>

      <div class="card">
        <h1>Dinner Roulette (Kerala)</h1>
        <p>Tap spin and let fate pick dinner.</p>

        <div class="wheel-area">
          <div class="wheel-shell">
            <div class="pointer" aria-hidden="true"></div>
            <div class="rotor" id="rotor" aria-hidden="true">
              <div class="wheel" id="wheel" aria-label="Roulette wheel"></div>
              <div class="labels" id="labels" aria-hidden="true"></div>
            </div>
            <div class="hub" aria-hidden="true"></div>
          </div>

          <div class="btn-row">
            <button id="spinBtn">Spin</button>
            <div class="result" aria-live="polite">
              <span class="small">Tonight’s pick</span>
              <span class="big" id="resultText">—</span>
            </div>
          </div>
        </div>

      </div>
    </div>

    <script>
      const options = [
        "Porotta + Beef Curry",
        "Mandi",
        "Chicken Biriyani",
        "Beef Biriyani",
        "Kappa + Chicken Curry",
        "Dosa + Chicken Curry",
        "Idiyappam + Chicken Stew",
        "Appam + Chicken Stew",
        "Puttu + Kadala Curry",
        "Kuzhimanthi (Chicken)",
        "Neychor + Chicken Roast",
        "Pathiri + Chicken Curry",
        "Meen Curry + Rice",
        "Thalassery Biriyani",
        "Kozhi Nirachathu + Rice",
      ];

      const rotorEl = document.getElementById("rotor");
      const wheelEl = document.getElementById("wheel");
      const labelsEl = document.getElementById("labels");
      const resultTextEl = document.getElementById("resultText");
      const spinBtn = document.getElementById("spinBtn");
      const topGifEl = document.getElementById("topGif");

      const DEFAULT_GIF = "https://media1.tenor.com/m/ekOo-1_fJlYAAAAd/spice-adams.gif";
      const SELECTED_GIF = "https://media1.tenor.com/m/QzWfXyJMw4EAAAAd/taste-ohm-shanthi-oshaana.gif";

      const sliceCount = options.length;
      const sliceDeg = 360 / sliceCount;

      let currentRotation = 0;
      let spinning = false;

      function buildWheel() {
        // Simple repeating palette
        const palette = ["#25335f", "#1f3b4d", "#3a2d5f", "#2e4b3a", "#4c2a2a"];

        const stops = options
          .map((_, i) => {
            const start = i * sliceDeg;
            const end = (i + 1) * sliceDeg;
            const color = palette[i % palette.length];
            return `${color} ${start}deg ${end}deg`;
          })
          .join(", ");

        wheelEl.style.background = `conic-gradient(${stops})`;

        // Labels
        labelsEl.innerHTML = "";
        options.forEach((text, i) => {
          const mid = i * sliceDeg + sliceDeg / 2;
          const label = document.createElement("div");
          label.className = "label";
          label.style.transform = `rotate(${mid}deg) translate(10px, -120px) rotate(90deg)`;
          label.textContent = text;
          labelsEl.appendChild(label);
        });
      }

      function normalizeDeg(deg) {
        let d = deg % 360;
        if (d < 0) d += 360;
        return d;
      }

      function pickIndexFromRotation(finalRotationDeg) {
        // Pointer is at top (0deg). The slice at the pointer corresponds to angle (360 - rotation).
        const atPointer = normalizeDeg(360 - finalRotationDeg);
        return Math.floor(atPointer / sliceDeg) % sliceCount;
      }

      function spin() {
        if (spinning) return;
        spinning = true;
        spinBtn.disabled = true;
        resultTextEl.textContent = "Spinning…";
        if (topGifEl) topGifEl.src = DEFAULT_GIF;

        const extraTurns = 6 + Math.floor(Math.random() * 5); // 6..10
        const randomOffset = Math.random() * 360;
        const finalRotation = currentRotation + extraTurns * 360 + randomOffset;

        rotorEl.style.transform = `rotate(${finalRotation}deg)`;

        const durationMs = 3600;
        window.setTimeout(() => {
          currentRotation = finalRotation;
          const chosenIndex = pickIndexFromRotation(normalizeDeg(finalRotation));
          resultTextEl.textContent = options[chosenIndex];
          if (topGifEl) topGifEl.src = SELECTED_GIF;

          spinning = false;
          spinBtn.disabled = false;
        }, durationMs + 60);
      }

      buildWheel();
      spinBtn.addEventListener("click", spin);

      // Improve tap responsiveness on mobile
      document.addEventListener(
        "touchstart",
        () => {
          /* no-op */
        },
        { passive: true }
      );
    </script>
  </body>
</html>
